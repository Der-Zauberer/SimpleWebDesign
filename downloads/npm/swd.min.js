class Swd{static #a;#b=!1;#c=[];#d;#e=new Map;#f=new Map;#g;constructor(){if(Swd.#a)throw Error("Swd is already instantiated!");Swd.#a=this,document.addEventListener("readystatechange",t=>{"interactive"===t.target.readyState&&(this.#b=!0,this.#c.forEach(t=>t()),new MutationObserver((t,e)=>{for(let i of t){let n=Array.from(i.target.querySelectorAll("*")).filter(t=>this.#h(t,"i18n")).filter(t=>!t.swdIgnoreNextI18nUpdate||(t.swdIgnoreNextI18nUpdate=!1,!1));0!==n.length&&this.#i(n)}}).observe(document,{attributes:!0,childList:!0,subtree:!0}))})}from(t){if(!t)throw ReferenceError("element is undefined");for(let[e,i]of Object.entries(new SwdElementRef(t)))t[e]||(t[e]=i);return t.swdElementRef=t,t}query(t){let e=document.querySelector(t);if(!e)throw ReferenceError("query result is undefined");return this.from(e)}doAfterRendered(t){this.#b?t():this.#c.push(t)}configureLanguages(t){for(let e of t.languages)this.#e.set(e.locale,e.src);this.#d=t.fallback}async setLanguage(t){let e=this.#e.get(t)||this.#e.get(this.#d);if(void 0==e)return;let i=await fetch(e).then(t=>t.text());for(let n of(this.#f.clear(),i.split(/\r?\n/gm))){let[s,o]=n.split("=").map(t=>t.trim());s&&o&&this.#f.set(s,o)}this.#g=t,this.doAfterRendered(()=>this.#i(Array.from(document.querySelectorAll("*")).filter(t=>this.#h(t,"i18n"))))}i18n(t){let e=this.#f.get(t);return e||console.warn(`I18n key "${t}" does not exist in language "${this.#g}"`),e||`${t}[${this.#g}]`}#i(t){for(let e of this.filterElementsByAttributeName("i18n",t))e.value=this.i18n(e.key),e.element.swdIgnoreNextI18nUpdate=!0}#h(i,n){return 0!==Array.from(i.attributes).filter(t=>t.name===n||t.name.startsWith(`${n}-`)).length}filterElementsByAttributeName(t,e){let i=[];for(let n of e)for(let s of n.attributes)if(s.name===t&&"INPUT"===n.tagName)i.push({key:s.value,element:n,get value(){return n.value},set value(value){n.value=value}});else if(s.name===t)i.push({key:s.value,element:n,get value(){return n.innerText},set value(value){n.innerText=value}});else if(s.name===`${t}-innerhtml`)i.push({key:s.value,element:n,get value(){return n.innerHTML},set value(value){n.innerHTML=value}});else if(s.name.startsWith(`${t}-`)){let o=s.name.substring(t.length+1);i.push({key:s.value,element:n,get value(){return n.getAttribute(o)},set value(value){n.setAttribute(o,value)}})}return i}}class SwdUtils{static getScrollableChild(t){let e=[t];for(;e.length;){let i=e.pop(),n=getComputedStyle(i).overflowY;if("auto"===n||"scroll"===n)return i;e.push(...i.children)}}}window.swd=new Swd,document.addEventListener("click",t=>(SwdNavigation.autoHide(t),SwdDropdown.autoHide(t))),document.addEventListener("input",t=>t.target.setAttribute("dirty","true")),document.addEventListener("scroll",()=>requestAnimationFrame(SwdDropdown.resizeAllDropdowns),{passive:!0}),window.addEventListener("resize",()=>requestAnimationFrame(SwdDropdown.resizeAllDropdowns)),window.addEventListener("wheel",t=>(SwdNavigation.wheel(t),SwdDialog.wheel(t)),{passive:!1}),window.addEventListener("touchstart",t=>(SwdNavigation.touchStart(t),SwdDialog.touchStart(t))),window.addEventListener("touchmove",t=>(SwdNavigation.touchMove(t),SwdDialog.touchMove(t)),{passive:!1});class SwdElementRef{#j;constructor(t){this.#j=t}query=t=>{let e=this.#j.querySelector(t);if(!e)throw ReferenceError("query result is undefined");return e};hide=()=>(this.#j.setAttribute("hidden","true"),this.#j);show=()=>(this.#j.removeAttribute("hidden"),this.#j);isHidden=()=>this.#j.hasAttribute("hidden");toggle=()=>(this.isHidden()?this.show():this.hide(),this.#j);commentExpose=()=>(this.#j.innerHTML=this.#j.innerHTML.replace("<!--","").replace("-->",""),this.show(),this.#j);commentCover=()=>(this.hide(),this.#j.innerHTML="<!--"+this.#j.innerHTML+"-->",this.#j);isCommentHidden=()=>this.#j.innerHTML.trim().startsWith("<!--")&&this.#j.innerHTML.trim().endsWith("-->");commentToggle=()=>(this.isCommentHidden()?this.commentExpose():this.commentCover(),this.#j);writeObject=t=>{let e=[this.#j,...this.#j.querySelectorAll("*")];for(let i of swd.filterElementsByAttributeName("name",e)){let n=i.key.replace(/\[(\w+)\]/g,".$1").split(".").filter(Boolean),s=n.reduce((t,e)=>{let i=Number(e);return Array.isArray(t)&&!isNaN(i)?t[i]:t&&void 0!==t[e]?t[e]:void 0},t);i.value=s||""}let o=[this.#j,...this.#j.querySelectorAll("*")];for(let r of swd.filterElementsByAttributeName("bind",o))r.value=Function(...Object.keys(t),`return ${r.key}`)(...Object.values(t));return this.#j};readObject=t=>{let e=[this.#j,...this.#j.querySelectorAll("*")];for(let i of swd.filterElementsByAttributeName("name",e)){let n=0!==i.value.length?i.value:void 0,s=i.key.replace(/\[(\w+)\]/g,".$1").split(".").filter(Boolean);t||(t=isNaN(s[0])?{}:[]),s.reduce((t,e,i)=>{let o=Number(e);if(i!==s.length-1)return Array.isArray(t)&&!isNaN(o)?(t[o]||(t[o]={}),t[o]):((void 0===t[e]||"object"!=typeof t[e])&&(t[e]=isNaN(Number(s[i+1]))?{}:[]),t[e]);Array.isArray(t)&&!isNaN(o)?t[o]=n:t[e]=n},t)}return t}}class SwdComponent extends HTMLElement{#k=[];#l;constructor(){super(),this.#l=new MutationObserver((t,e)=>{this.swdOnUpdate([...t])}),this.#l.observe(this,{attributes:!0,childList:!0,subtree:!1}),swd.doAfterRendered(()=>this.swdAfterRendered())}connectedCallback(){this.swdOnInit()}disconnectedCallback(){for(let t of(this.swdOnDestroy(),this.#k))t.target.removeEventListener(t.event,t.action);this.#l.disconnect()}swdOnInit(){}swdAfterRendered(){}swdOnUpdate(t){}swdOnDestroy(){}swdRegisterManagedEvent(t,e,i){this.#k.push({target:t,event:e,action:i}),t.addEventListener(e,i)}}class SwdNavigation extends SwdComponent{static #m=void 0;static #n=!1;static #o=0;show(){SwdNavigation.autoHide(),SwdNavigation.#m=this,this.setAttribute("shown","true"),SwdNavigation.#n=!0,Array.from(document.body.querySelectorAll("*")).filter(t=>!SwdNavigation.#m.contains(t)&&!t.contains(SwdNavigation.#m)).forEach(t=>t.setAttribute("inert","")),document.body.setAttribute("scroll-lock",""),SwdNavigation.#m.focus()}hide(){this.removeAttribute("shown"),SwdNavigation.#m=void 0,this.scrollTop=0,document.body.querySelectorAll("[inert]").forEach(t=>t.removeAttribute("inert")),document.body.removeAttribute("scroll-lock")}isHidden(){return!this.hasAttribute("shown")}toggle(){this.isHidden()?this.show():this.hide()}static autoHide(t){if(SwdNavigation.#m){if(this.#n){this.#n=!1;return}(!(t&&SwdNavigation.#m.contains(t.target))||"A"==t.target.nodeName&&t.target.hasAttribute("href"))&&(SwdNavigation.#m.hide(),SwdNavigation.#m=void 0)}}static wheel(t){!SwdNavigation.#m||SwdNavigation.#m.contains(t.target)||(SwdNavigation.#m.scrollTop+=t.deltaY,t.preventDefault())}static touchStart(t){SwdNavigation.#m&&(SwdNavigation.#m.focus(),SwdNavigation.#o=t.touches[0].clientY)}static touchMove(t){if(!SwdNavigation.#m||t.targetTouches[0].target===SwdNavigation.#m||SwdNavigation.#m.contains(t.targetTouches[0].target))return;let e=SwdNavigation.#o-t.touches[0].clientY;SwdNavigation.#m.scrollTop+=e,SwdNavigation.#o=t.touches[0].clientY,t.preventDefault()}}class SwdInput extends SwdComponent{#p=()=>{this.#q(),this.#p};#r=()=>this.#s?.focus();#t=()=>{this.#s?.focus(),this.#s&&(this.#s.value=""),this.#s.dispatchEvent(new Event("input",{bubbles:!0}))};#s;#u;#v;#w=0;swdOnUpdate(){if(this.#w-- >0)return;let t=this.querySelector("input"),e=this.querySelector("[swd-input-icon]"),i=this.querySelector("[swd-input-reset-icon]");t!==this.input&&(this.#s?.removeEventListener("input",this.#p),t?.addEventListener("input",this.#p),this.#s=t),e!==this.inputIcon&&(this.#u?.removeEventListener("click",this.#r),e?.addEventListener("click",this.#r),this.#u=e),i!==this.inputResetIcon&&(this.#v?.removeEventListener("click",this.#t),i?.addEventListener("click",this.#t),this.#v=i),this.#x()}swdAfterRendered(){this.#q()}swdOnDestroy(){this.#s?.removeEventListener("input",this.#p)}#q(){let s=this.querySelector("[swd-input-icon]"),o=this.querySelector("[swd-input-reset-icon]");if(!s||!o)return;let r=this.#s.value.length>0;r?s.setAttribute("hidden","true"):s.removeAttribute("hidden"),r?o.removeAttribute("hidden"):o.setAttribute("hidden","true")}#x(){if(!this.#s)return;let d=this.querySelector("swd-input-range");if(d){d.innerText=`${this.#s.value.length}`,this.#w++;let l=this.#s.getAttribute("maxlength");l&&(d.innerText+=`/${l}`,this.#w++)}let a=this.querySelector("swd-input-error");a&&(this.#s.checkValidity()?a.innerText="":a.innerText=this.#s.validationMessage,this.#w++)}}class SwdDropdown extends SwdComponent{static #y=[];#z;#A;#B;#C;#D;#p=t=>{this.isHidden()&&this.show(),this.#D&&this.#z&&!this.#z.hasAttribute("readonly")&&"button"!==this.#z.type&&this.#D.filter(t.target.value)};swdOnInit(){this.swdRegisterManagedEvent(this,"click",t=>{this.#z&&this.#z!==document.activeElement&&this.#z.focus(),this.#B&&(this.isHidden()&&!this.#B.contains(t.target)?this.show():(this.isHidden()||!this.#B?.contains(t.target))&&this.hide())}),this.swdRegisterManagedEvent(this,"keydown",t=>{if("Enter"===t.key&&this.#D&&this.#z&&this.isHidden()){t.preventDefault(),this.show();return}if(!(!this.#D||this.isHidden()))switch(t.key){case"ArrowUp":case"ArrowLeft":this.#D.previous(),t.preventDefault();break;case"ArrowDown":case"ArrowRight":this.#D.next(),t.preventDefault();break;case"Enter":t.preventDefault(),this.#D.select(),this.hide();break;case"Escape":this.#D.reset(),this.hide();break;case"Delete":case"Backspace":this.#z&&this.#z.hasAttribute("readonly")&&(this.#z.value="")}})}swdOnUpdate(t){this.#z?.removeEventListener("input",this.#p);let e=this.querySelectorAll("swd-dropdown input:not(swd-dropdown-content *)");e.length>0&&(this.#z=e[0]),e.length>1&&(this.#A=e[1]),this.#B=this.querySelector("swd-dropdown-content"),this.#z?.addEventListener("input",this.#p),this.#B&&(this.#D=this.#B.querySelector("swd-selection"),this.#C?.disconnect(),this.#C=new MutationObserver((t,e)=>{this.#E()}),this.#C.observe(this,{attributes:!1,childList:!0,subtree:!0})),this.#D&&this.#D.setOnSelect((t,e)=>{this.#z&&this.#A?(this.#z.value=t,this.#A.value=e,this.#z.dispatchEvent(new Event("input")),this.#A.dispatchEvent(new Event("input"))):this.#z&&(this.#z.value=e,this.#z.dispatchEvent(new Event("input"))),this.hide()})}show(){this.#B&&(this.#B.setAttribute("shown","true"),this.#E(),SwdDropdown.#y.push(this),this.#D&&this.#z&&!this.#z.hasAttribute("readonly")&&"button"!==this.#z.type&&this.#D.filter(this.#z.value))}hide(){this.#B&&(this.#B.removeAttribute("shown"),SwdDropdown.#y=SwdDropdown.#y.filter(t=>t!==this))}isHidden(){return!this.#B||!this.#B.hasAttribute("shown")}toggle(){this.isHidden()?this.show():this.hide()}#E(){Object.assign(this.#B.style,{left:"",maxWidth:"",top:"",maxHeight:""});let h=this.getBoundingClientRect();this.#B.style.minWidth=`${h.width}px`;let u=this.#B.getBoundingClientRect();if(this.#B.hasAttribute("fixed")){let w={top:`${h.bottom}px`,maxHeight:`${window.innerHeight-h.bottom}px`,left:`${h.left}px`,maxWidth:`${window.innerWidth-h.left}px`};if(h.bottom+u.height>window.innerHeight&&h.top>window.innerHeight-h.bottom){let c=h.top-u.height;w.top=`${c>0?c:0}px`,w.maxHeight=`${h.top}px`}if(h.left+u.width>window.innerWidth&&h.left>window.innerWidth-h.right){let g=h.right-u.width;w.left=`${g>0?g:0}px`,w.maxWidth=`${h.right}px`}Object.assign(this.#B.style,w)}else{let p={bottom:"initial",maxHeight:`${window.innerHeight-h.bottom}px`,right:"initial",maxWidth:`${window.innerWidth-h.left}px`};h.bottom+u.height>window.innerHeight&&h.top>window.innerHeight-h.bottom&&(p.bottom="100%",p.maxHeight=`${h.top}px`),h.left+u.width>window.innerWidth&&h.left>window.innerWidth-h.right&&(p.right="0",p.maxWidth=`${h.right}px`),Object.assign(this.#B.style,p)}}static resizeAllDropdowns(){for(let t of SwdDropdown.#y)t.#E()}static autoHide(t){for(let e of SwdDropdown.#y){if(t&&e.contains(t.target)&&!("A"==t.target.nodeName&&t.target.hasAttribute("href")))return;e.hide()}}}class SwdSelection extends SwdComponent{#F;#G=new Set;#H;value;swdOnInit(){this.swdRegisterManagedEvent(this,"click",t=>this.select(t.target))}next(){this.#I(!0,!1)}previous(){this.#I(!1,!1)}#I(f,v){if(0===this.children.length)return;let m=this.querySelector("[selected]"),b=v?void 0:m,S=0;do{let E=b?f?b.nextElementSibling:b.previousElementSibling:f?this.firstElementChild:this.lastElementChild;E||(E=f?this.firstElementChild:this.lastElementChild),b=E}while(("A"!==b.nodeName||b.hasAttribute("hidden"))&&S++<this.children.length);m?.removeAttribute("selected"),b.setAttribute("selected","true");let A=this.parentElement,y=A.getBoundingClientRect(),N=b.getBoundingClientRect(),D=b.offsetTop;D+N.height>A.scrollTop+y.height?A.scrollTop=D+N.height-y.height:D<A.scrollTop&&(A.scrollTop=D)}reset(){let t=this.querySelector("[selected]");t&&t!==this.#H&&(t.removeAttribute("selected"),this.#H.setAttribute("selected","true"))}select(t){let e=t||this.querySelector("[selected]");for(;e&&e!==this&&"A"!==e.tagName;)e=e.parentNode;if(!e||"A"!==e.nodeName||e.hasAttribute("hidden"))return;this.#H?.removeAttribute("selected"),this.#H=e,this.#H.setAttribute("selected","true"),this.value=this.#H.getAttribute("value")||this.#H.innerText;let i=this.#H.getAttribute("display")||this.#H.innerText,n=new Event("select",{bubbles:!0});n.value=this.value,n.name=i,this.#H.dispatchEvent(n),this.#F?.(i,this.value)}setOnSelect(t){this.#F=t}filter(t){let e=new Event("filter",{cancelable:!0,target:this});if(this.hasAttribute("onfilter")&&Function("event",this.getAttribute("onfilter")).call(this,e),e.returnValue&&this.dispatchEvent(e),!e.returnValue)return;if(!t||""==t){Array.from(this.children).forEach(t=>t.removeAttribute("hidden"));return}let i=t.toLowerCase().replace(/[^\w\d\s]/gm,"");for(let n of this.children){let s=!1,o=[],r=n.innerHTML.toLowerCase().replace(/<\/?[^>]*>/g," ").replace(/[^\w\d\s]/gm,"").replace(/\s{2,}/g," ");for(o.push(r);-1!==r.indexOf(" ");)o.push(r=r.substring(r.indexOf(" ")+1));for(let d of o)if(d.startsWith(i)){s=!0;break}s?n.removeAttribute("hidden"):n.setAttribute("hidden","true")}this.#I(!0,!0)}}class SwdDialog extends SwdComponent{static #J;static #o=0;show(){SwdDialog.#J&&SwdDialog.#J.hide(),SwdDialog.#J=this,this.setAttribute("shown","true"),Array.from(document.body.querySelectorAll("*")).filter(t=>!SwdDialog.#J.contains(t)&&!t.contains(SwdDialog.#J)).forEach(t=>t.setAttribute("inert","")),document.body.setAttribute("scroll-lock",""),SwdUtils.getScrollableChild(this).scrollTop=0}hide(){SwdDialog.#J=void 0,this.removeAttribute("shown"),document.body.querySelectorAll("[inert]").forEach(t=>t.removeAttribute("inert")),document.body.removeAttribute("scroll-lock","")}isHidden(){return!this.hasAttribute("shown")}toggle(){this.isHidden()?this.show():this.hide()}static hide(){SwdDialog.#J.hide()}static wheel(t){!SwdDialog.#J||t.target!==SwdDialog.#J&&SwdDialog.#J.contains(t.target)||(SwdUtils.getScrollableChild(SwdDialog.#J).scrollTop+=t.deltaY,t.preventDefault())}static touchStart(t){SwdDialog.#J&&(SwdDialog.#o=t.touches[0].clientY)}static touchMove(t){if(!SwdDialog.#J||SwdDialog.#J.children[0].contains(t.targetTouches[0].target))return;let e=SwdDialog.#o-t.touches[0].clientY;SwdUtils.getScrollableChild(SwdDialog.#J).scrollTop+=e,SwdDialog.#o=t.touches[0].clientY,t.preventDefault()}}class SwdCode extends SwdComponent{#K;constructor(){super(),this.#K=this.attachShadow({mode:"open"})}swdOnUpdate(){this.#L()}#L(){switch(this.getAttribute("swd-code-language")){case"html":this.#K.innerHTML=this.#M(this.innerHTML);break;case"css":this.#K.innerHTML=this.#N(this.innerHTML);break;default:this.#K.innerHTML=this.innerHTML}this.#K.innerHTML=this.#K.innerHTML+'<style>@import "/SimpleWebDesign/resources/style.css"</style>'}#M($){let x="",I=!1,T=!1,C=!1,H=!1,_=0;for(let L=0;L<$.length;L++)I||H||!(L+3<$.length)||"&lt;"!=$.substring(L,L+4)||L+7<$.length&&"&lt;!--"==$.substring(L,L+7)?I&&L+3<$.length&&"&gt;"==$.substring(L,L+4)?(x+=$.substring(_,L),T&&(x+="</span>"),x+="&gt;</span>",I=!1,T=!1,L+=3,_=L+1):!I||H||T||" "!=$.charAt(L)?I&&!H&&T&&'"'==$.charAt(L)?(x+=C?$.substring(_,L)+'"</span>':$.substring(_,L)+'<span class="green-text">"',C=!C,_=L+1):I||H||!(L+7<$.length)||"&lt;!--"!=$.substring(L,L+7)?H&&L+6<$.length&&"--&gt;"==$.substring(L,L+6)&&(x+=$.substring(_,L)+"--&gt;</span>",H=!1,L+=6,_=L):(x+=$.substring(_,L)+'<span class="grey-text">&lt;!--',H=!0,L+=7,_=L):(x+=$.substring(_,L)+'<span class="aqua-text">',T=!0,_=L):(x+=$.substring(_,L)+'<span class="blue-text">&lt;',I=!0,L+=4,_=L);return x+$.substring(_,$.length)}#N(R){let k="",q=!1,O=!1,U=!1,M=0;for(let W=0;W<R.length;W++)U||q||"{"!=R.charAt(W)?!U&&q&&":"==R.charAt(W)?(k+=R.substring(M,W)+'</span>:<span class="green-text">',O=!0,M=++W):!U&&q&&"}"==R.charAt(W)?(k+=R.substring(M,W)+'</span>}<span class="blue-text">',q=!1,O=!1,M=++W):!U&&O&&";"==R.charAt(W)?(k+=R.substring(M,W)+'</span>;<span class="aqua-text">',q=!0,O=!1,M=++W):!U&&W+1<R.length&&"/*"==R.substring(W,W+2)?(k+=R.substring(M,W)+'<span class="grey-text">/*',U=!0,W+=2,M=W):U&&W+1<R.length&&"*/"==R.substring(W,W+2)&&(k+=R.substring(M,W)+"*/</span>",U=!1,W+=2,M=W):(k+=R.substring(M,W)+'</span>{<span class="aqua-text">',q=!0,M=++W);return'<span class="blue-text">'+(k+=R.substring(M,R.length-1))+"</span>"}}customElements.define("swd-navigation",SwdNavigation),customElements.define("swd-input",SwdInput),customElements.define("swd-dropdown",SwdDropdown),customElements.define("swd-selection",SwdSelection),customElements.define("swd-dialog",SwdDialog),customElements.define("swd-code",SwdCode);