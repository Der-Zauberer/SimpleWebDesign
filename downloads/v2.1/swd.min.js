class Swd{static #a;#b=!1;#c=[];#d;#e=new Map;#f=new Map;#g;constructor(){if(Swd.#a)throw Error("Swd is already instantiated!");Swd.#a=this,document.addEventListener("readystatechange",t=>{"interactive"===t.target.readyState&&(this.#b=!0,this.#c.forEach(t=>t.call()))}),new MutationObserver((t,e)=>{if(0!==this.#f.length)for(let s of t){if(s.target.swdIgnoreNextI18nUpdate){s.target.swdIgnoreNextI18nUpdate=!1;return}this.#h([s.target])}}).observe(document,{attributes:!0,childList:!0,subtree:!0})}from(t){if(!t)throw ReferenceError("element is undefined");for(let[e,s]of Object.entries(new SwdElementRef(t)))t[e]||(t[e]=s);return t.swdElementRef=t,t}query(t){let e=document.querySelector(t);if(!e)throw ReferenceError("query result is undefined");return this.from(e)}doAfterRendered(t){this.#b?t.call():this.#c.push(t)}configureLanguages(t){for(let e of t.languages)this.#e.set(e.locale,e.src);this.#d=t.fallback}setLanguage(t){let e=this.#e.get(t)||this.#e.get(this.#d);void 0!=e&&fetch(e).then(t=>t.text()).then(e=>{this.#f.clear();let s=e.split(/\r?\n/gm);for(let n of s){let[i,r]=n.split("=").map(t=>t.trim());i&&r&&this.#f.set(i,r)}this.#g=t,this.#b&&this.#h(document.querySelectorAll("*"))})}#h(t){for(let e of this.filterElementsByAttributeName("i18n",t))e.value=this.#f.get(e.key)||`${e.key}[${this.#g}]`,e.element.swdIgnoreNextI18nUpdate=!0}filterElementsByAttributeName(t,e){let s=[];for(let n of e)for(let i of n.attributes)if(i.name===t&&"INPUT"===n.tagName)s.push({key:i.value,element:n,get value(){return n.value},set value(value){n.value=value}});else if(i.name===t)s.push({key:i.value,element:n,get value(){return n.innerText},set value(value){n.innerText=value}});else if(i.name===`${t}-innerhtml`)s.push({key:i.value,element:n,get value(){return n.innerHTML},set value(value){n.innerHTML=value}});else if(i.name.startsWith(`${t}-`)){let r=i.name.substring(t.length+1);s.push({key:i.value,element:n,get value(){return n.getAttribute(r)},set value(value){n.setAttribute(r,value)}})}return s}}window.swd=new Swd,window.addEventListener("resize",()=>{SwdDropdown.resizeAllDropdowns(),SwdNavigation.autoHide()}),document.addEventListener("scroll",()=>SwdDropdown.resizeAllDropdowns()),document.addEventListener("click",t=>{SwdNavigation.autoHide(t),SwdDropdown.autoHide(t)}),document.addEventListener("input",t=>t.target.setAttribute("dirty","true"));class SwdElementRef{#i;constructor(t){this.#i=t}query=t=>{let e=this.#i.querySelector(t);if(!e)throw ReferenceError("query result is undefined");return e};hide=()=>(this.#i.setAttribute("hidden","true"),this.#i);show=()=>(this.#i.removeAttribute("hidden"),this.#i);isHidden=()=>this.#i.hasAttribute("hidden");toggle=()=>(this.isHidden()?this.show():this.hide(),this.#i);commentExpose=()=>(this.#i.innerHTML=this.#i.innerHTML.replace("<!--","").replace("-->",""),this.show(),this.#i);commentCover=()=>(this.hide(),this.#i.innerHTML="<!--"+this.#i.innerHTML+"-->",this.#i);isCommentHidden=()=>this.#i.innerHTML.trim().startsWith("<!--")&&this.#i.innerHTML.trim().endsWith("-->");commentToggle=()=>(this.isCommentHidden()?this.commentExpose():this.commentCover(),this.#i);writeObject=t=>{let e=[this.#i,...this.#i.querySelectorAll("*")];for(let s of swd.filterElementsByAttributeName("name",e)){let n=s.key.replace(/\[(\w+)\]/g,".$1").split(".").filter(Boolean),i=n.reduce((t,e)=>{let s=Number(e);return Array.isArray(t)&&!isNaN(s)?t[s]:t&&void 0!==t[e]?t[e]:void 0},t);s.value=i||""}let r=[this.#i,...this.#i.querySelectorAll("*")];for(let o of swd.filterElementsByAttributeName("bind",r))o.value=Function(...Object.keys(t),`return ${o.key}`)(...Object.values(t));return this.#i};readObject=t=>{let e=[this.#i,...this.#i.querySelectorAll("*")];for(let s of swd.filterElementsByAttributeName("name",e)){let n=0!==s.value.length?s.value:void 0,i=s.key.replace(/\[(\w+)\]/g,".$1").split(".").filter(Boolean);t||(t=isNaN(i[0])?{}:[]),i.reduce((t,e,s)=>{let r=Number(e);if(s!==i.length-1)return Array.isArray(t)&&!isNaN(r)?(t[r]||(t[r]={}),t[r]):((void 0===t[e]||"object"!=typeof t[e])&&(t[e]=isNaN(Number(i[s+1]))?{}:[]),t[e]);Array.isArray(t)&&!isNaN(r)?t[r]=n:t[e]=n},t)}return t}}class SwdComponent extends HTMLElement{#j=[];#k;constructor(){super(),this.#k=new MutationObserver((t,e)=>{this.swdOnUpdate([...t])}),this.#k.observe(this,{attributes:!0,childList:!0,subtree:!1}),swd.doAfterRendered(()=>this.swdAfterRendered())}connectedCallback(){this.swdOnInit()}disconnectedCallback(){for(let t of(this.swdOnDestroy(),this.#j))t.target.removeEventListener(t.event,t.action);this.#k.disconnect()}swdOnInit(){}swdAfterRendered(){}swdOnUpdate(t){}swdOnDestroy(){}swdRegisterManagedEvent(t,e,s){this.#j.push({target:t,event:e,action:s}),t.addEventListener(e,s)}}class SwdNavigation extends SwdComponent{static #l=void 0;static #m=!1;show(){SwdNavigation.autoHide(),SwdNavigation.#l=this,this.setAttribute("shown","true"),SwdNavigation.#m=!0}hide(){this.removeAttribute("shown"),SwdNavigation.#l=void 0,this.scrollTop=0}isHidden(){return!this.hasAttribute("shown")}toggle(){this.isHidden()?this.show():this.hide()}static autoHide(t){if(SwdNavigation.#l){if(this.#m){this.#m=!1;return}(!(t&&SwdNavigation.#l.contains(t.target))||"A"==t.target.nodeName&&t.target.hasAttribute("href"))&&(SwdNavigation.#l.hide(),SwdNavigation.#l=void 0)}}}class SwdInput extends SwdComponent{#n;#o=0;swdOnUpdate(){if(this.#o-- >0)return;let t=this.querySelector("input");t!==this.input&&(this.#n?.removeEventListener("input",t=>this.#p()),t?.addEventListener("input",t=>this.#p()),this.#n=t),this.#p()}swdOnDestroy(){this.#n?.removeEventListener("input",t=>this.#p())}#p(){if(!this.#n)return;let t=this.querySelector("swd-input-range");if(t){t.innerText=`${this.#n.value.length}`,this.#o++;let e=this.#n.getAttribute("maxlength");e&&(t.innerText+=`/${e}`,this.#o++)}let s=this.querySelector("swd-input-error");s&&(this.#n.checkValidity()?s.innerText="":s.innerText=this.#n.validationMessage,this.#o++)}}class SwdDropdown extends SwdComponent{static #q=[];#r;#s;#t;#u;#v;#w=t=>{this.isHidden()&&this.show(),this.#v&&this.#r&&!this.#r.hasAttribute("readonly")&&this.#v.filter(t.target.value)};swdOnInit(){this.swdRegisterManagedEvent(this,"click",t=>{let e=t=>{if(!this.isHidden())return this.#v?this.#v.contains(t.target):!this.#t||!this.#t.contains(t.target)};this.#t&&(this.isHidden()?this.show():e(t)&&this.hide())}),this.swdRegisterManagedEvent(this,"keydown",t=>{if(this.#v&&this.#r&&this.isHidden()&&"Enter"===t.key){t.preventDefault(),this.hide();return}if(!(!this.#v||this.isHidden()))switch(t.key){case"ArrowUp":case"ArrowLeft":this.#v.previous(),t.preventDefault();break;case"ArrowDown":case"ArrowRight":this.#v.next(),t.preventDefault();break;case"Enter":t.preventDefault(),this.isHidden()?this.show():(this.#v.select(),this.hide());break;case"Escape":this.#r&&document.activeElement.blur(),this.#v.reset(),this.hide();break;case"Delete":case"Backspace":this.#r&&this.#r.hasAttribute("readonly")&&(this.#r.value="")}})}swdOnUpdate(t){this.#r?.removeEventListener("input",this.#w);let e=this.querySelectorAll("swd-dropdown input:not(swd-dropdown-content *)");e.length>0&&(this.#r=e[0]),e.length>1&&(this.#s=e[1]),this.#t=this.querySelector("swd-dropdown-content"),this.#r?.addEventListener("input",this.#w),this.#t&&(this.#v=this.#t.querySelector("swd-selection"),this.#u?.disconnect(),this.#u=new MutationObserver((t,e)=>{this.#x()}),this.#u.observe(this,{attributes:!1,childList:!0,subtree:!0})),this.#v&&this.#r&&this.#v.setOnSelect((t,e)=>{this.#s?(this.#r.value=t,this.#s.value=e,this.#r.dispatchEvent(new Event("input")),this.#s.dispatchEvent(new Event("input")),this.#r.dispatchEvent(new Event("select")),this.#s.dispatchEvent(new Event("select"))):(this.#r.value=e,this.#r.dispatchEvent(new Event("input")),this.#r.dispatchEvent(new Event("select")))})}show(){this.#t&&(this.#t.setAttribute("shown","true"),SwdDropdown.#q.push(this),this.#v&&this.#r&&!this.#r.hasAttribute("readonly")&&this.#v.filter(this.#r.value))}hide(){this.#t&&(this.#t.removeAttribute("shown"),SwdDropdown.#q=SwdDropdown.#q.filter(t=>t!==this))}isHidden(){return!this.#t||!this.#t.hasAttribute("shown")}toggle(){this.isHidden()?this.show():this.hide()}#x(){this.#t.style.maxHeight="",this.#t.classList.remove("swd-dropdown-content-right"),this.#t.classList.remove("swd-dropdown-content-up");let t=this.getBoundingClientRect(),e=this.#t.getBoundingClientRect();e.right>window.innerWidth&&this.#t.classList.add("swd-dropdown-content-right"),e.bottom>window.innerHeight&&(t.top-e.height>window.innerHeight-e.bottom?(t.top-e.height<0&&(this.#t.style.maxHeight=`${t.top}px`),this.#t.classList.add("swd-dropdown-content-up")):this.#t.style.maxHeight=`${window.innerHeight-e.top}px`)}static resizeAllDropdowns(){for(let t of SwdDropdown.#q)t.#x()}static autoHide(t){for(let e of SwdDropdown.#q){if(t&&e.contains(t.target)&&!("A"==t.target.nodeName&&t.target.hasAttribute("href")))return;e.hide()}}}class SwdSelection extends SwdComponent{#y;#z;value;swdOnInit(){this.swdRegisterManagedEvent(this,"click",t=>this.select(t.target))}next(){this.#A(!0,!1)}previous(){this.#A(!1,!1)}#A(t,e){if(0===this.children.length)return;let s=this.querySelector("[selected]"),n=e?void 0:s;do{let i=n?t?n.nextElementSibling:n.previousElementSibling:t?this.firstElementChild:this.lastElementChild;if(!i)return;n=i}while("A"!==n.nodeName||n.hasAttribute("hidden"));s?.removeAttribute("selected"),n.setAttribute("selected","true");let r=this.parentElement,o=r.getBoundingClientRect(),d=n.getBoundingClientRect(),h=n.offsetTop;h+d.height>r.scrollTop+o.height?r.scrollTop=h+d.height-o.height:h<r.scrollTop&&(r.scrollTop=h)}reset(){let t=this.querySelector("[selected]");t&&this.#z&&t!==this.#z&&(t.removeAttribute("selected"),this.#z.addAttribute("selected","true"))}select(t){let e=t||this.querySelector("[selected]");if(!e||"A"!==e.nodeName||e.hasAttribute("hidden"))return;this.selected=e,this.value=this.selected.getAttribute("value")||this.selected.innerText;let s=this.selected.getAttribute("display")||this.selected.innerText;this.dispatchEvent(new Event("select")),this.#y?.(s,this.value)}setOnSelect(t){this.#y=t}filter(text){let event=new Event("filter",{cancelable:!0,target:this});if(this.hasAttribute("onfilter")&&eval(this.getAttribute("onfilter")),event.returnValue&&this.dispatchEvent(event),!event.returnValue)return;if(!text||""==text){Array.from(this.children).forEach(t=>t.removeAttribute("hidden"));return}let normalizedText=text.toLowerCase().replace(/[^\w\d\s]/gm,"");for(let element of this.children){let isElementVisible=!1,elementTextParts=[],currentTextPart=element.innerHTML.toLowerCase().replace(/<\/?[^>]*>/g," ").replace(/[^\w\d\s]/gm,"").replace(/\s{2,}/g," ");for(elementTextParts.push(currentTextPart);-1!==currentTextPart.indexOf(" ");)elementTextParts.push(currentTextPart=currentTextPart.substring(currentTextPart.indexOf(" ")+1));for(let searchString of elementTextParts)if(searchString.startsWith(normalizedText)){isElementVisible=!0;break}isElementVisible?element.removeAttribute("hidden"):element.setAttribute("hidden","true")}this.#A(!0,!0)}}class SwdDialog extends SwdComponent{static #B;show(){SwdDialog.#B&&SwdDialog.#B.hide(),SwdDialog.#B=this,this.setAttribute("shown","true")}hide(){SwdDialog.#B=void 0,this.removeAttribute("shown")}isHidden(){return!this.hasAttribute("shown")}toggle(){this.isHidden()?this.show():this.hide()}static hide(){SwdDialog.#B.hide()}}class SwdCode extends SwdComponent{#C;constructor(){super(),this.#C=this.attachShadow({mode:"open"})}swdOnUpdate(){this.#D()}#D(){switch(this.getAttribute("swd-code-language")){case"html":this.#C.innerHTML=this.#E(this.innerHTML);break;case"css":this.#C.innerHTML=this.#F(this.innerHTML);break;default:this.#C.innerHTML=this.innerHTML}this.#C.innerHTML=this.#C.innerHTML+'<style>@import "/SimpleWebDesign/resources/style.css"</style>'}#E(t){let e="",s=!1,n=!1,i=!1,r=!1,o=0;for(let d=0;d<t.length;d++)s||r||!(d+3<t.length)||"&lt;"!=t.substring(d,d+4)||d+7<t.length&&"&lt;!--"==t.substring(d,d+7)?s&&d+3<t.length&&"&gt;"==t.substring(d,d+4)?(e+=t.substring(o,d),n&&(e+="</span>"),e+="&gt;</span>",s=!1,n=!1,d+=3,o=d+1):!s||r||n||" "!=t.charAt(d)?s&&!r&&n&&'"'==t.charAt(d)?(e+=i?t.substring(o,d)+'"</span>':t.substring(o,d)+'<span class="green-text">"',i=!i,o=d+1):s||r||!(d+7<t.length)||"&lt;!--"!=t.substring(d,d+7)?r&&d+6<t.length&&"--&gt;"==t.substring(d,d+6)&&(e+=t.substring(o,d)+"--&gt;</span>",r=!1,d+=6,o=d):(e+=t.substring(o,d)+'<span class="grey-text">&lt;!--',r=!0,d+=7,o=d):(e+=t.substring(o,d)+'<span class="aqua-text">',n=!0,o=d):(e+=t.substring(o,d)+'<span class="blue-text">&lt;',s=!0,d+=4,o=d);return e+t.substring(o,t.length)}#F(h){let a="",l=!1,u=!1,w=!1,p=0;for(let c=0;c<h.length;c++)w||l||"{"!=h.charAt(c)?!w&&l&&":"==h.charAt(c)?(a+=h.substring(p,c)+'</span>:<span class="green-text">',u=!0,p=++c):!w&&l&&"}"==h.charAt(c)?(a+=h.substring(p,c)+'</span>}<span class="blue-text">',l=!1,u=!1,p=++c):!w&&u&&";"==h.charAt(c)?(a+=h.substring(p,c)+'</span>;<span class="aqua-text">',l=!0,u=!1,p=++c):!w&&c+1<h.length&&"/*"==h.substring(c,c+2)?(a+=h.substring(p,c)+'<span class="grey-text">/*',w=!0,c+=2,p=c):w&&c+1<h.length&&"*/"==h.substring(c,c+2)&&(a+=h.substring(p,c)+"*/</span>",w=!1,c+=2,p=c):(a+=h.substring(p,c)+'</span>{<span class="aqua-text">',l=!0,p=++c);return'<span class="blue-text">'+(a+=h.substring(p,h.length-1))+"</span>"}}customElements.define("swd-navigation",SwdNavigation),customElements.define("swd-input",SwdInput),customElements.define("swd-dropdown",SwdDropdown),customElements.define("swd-selection",SwdSelection),customElements.define("swd-dialog",SwdDialog),customElements.define("swd-code",SwdCode);